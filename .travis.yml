language: ruby
rvm:
  - 2.5.3
script:
  - bundle exec rails db:migrate RAILS_ENV=test
  - bundle exec rspec
  - bundle exec rake test

services:
  - docker

# make use of vm's
sudo: 'required'

after_install:
  - docker build --tag=bbb-dev .


deploy:
  provider: script
  script: bash docker_push
  on:
    branch: master
